<script>
  function initSummary() {
      populateYourBenefitsAndIncomeSection();

      toggleControls("hide");
      show("Summary");
  }

  function populateYourBenefitsAndIncomeSection() {
      populateTableOfUntaxedBenefits();
      displayUntaxedBenefitsAlert();
      displayNoLongerReceivingBenefitsAlert();
      displayTotalIncomeFromWork();
      populateTableOfOtherIncomes();
      displayTotalTaxableBenefits();
      displayTaxableBenefitsInfoOrAlert();
      populateTableTaxableBenefits();
  }

  function populateOtherHouseholdIncome() {
      populateTableOfUntaxedBenefits();
      displayUntaxedBenefitsAlert();
      displayTotalIncomeFromWork();
      populateTableOfOtherIncomes();
      displayTotalTaxableBenefits();
      displayTaxableBenefitsInfoOrAlert();
  }

  function populateTableOfUntaxedBenefits() {
      document.getElementById('yourBenefitsAndIncome.typeOfBenefitsList').innerHTML = buildListFromRadioAnswers('Which untaxed benefit did you get');
  }

  function displayUntaxedBenefitsAlert() {
      var question = getFromId('Did you get any untaxed benefits');
      var answer = map.get(question.questionType.modelId);
      if (answer === "false") {
          document.getElementById('yourBenefitsAndIncome.didNotClaimAlert').style.display = "block";
      }
  }

  function displayNoLongerReceivingBenefitsAlert() {
      var question = getFromId('Do you still get this benefit');
      var answer = map.get(question.questionType.modelId);
      if (answer === "false") {
          document.getElementById('yourBenefitsAndIncome.noLongerReceivingBenefitsAlert').style.display = "block";
      }
  }

  function displayTotalIncomeFromWork() {
      document.getElementById('yourBenefitsAndIncome.otherIncomeTotal').innerHTML = "£" + sumMultipleNumberOption('Select other income sources & enter amount');
  }

  function populateTableOfOtherIncomes() {
      document.getElementById('yourBenefitsAndIncome.otherIncomeTable').innerHTML = buildTableFromMultipleChoiceNumbersAnswers('Select other income sources & enter amount');
  }

  function displayTotalTaxableBenefits() {
      document.getElementById('yourBenefitsAndIncome.taxableBenefits').innerHTML = "£" + sumMultipleNumberOption('Select taxable benefits and enter amount');
  }

  function displayTaxableBenefitsInfoOrAlert() {
      var question = getFromId('Did you get any taxable benefits');
      var answer = map.get(question.questionType.modelId);
      if (answer === "true") {
          document.getElementById('yourBenefitsAndIncome.taxableBenefitsInfo').style.display = "block";
          document.getElementById('yourBenefitsAndIncome.taxableBenefitsWarn').style.display = "none";
      } else {
          document.getElementById('yourBenefitsAndIncome.taxableBenefitsInfo').style.display = "none";
          document.getElementById('yourBenefitsAndIncome.taxableBenefitsWarn').style.display = "block";
      }
  }

  function populateTableTaxableBenefits() {
      document.getElementById('yourBenefitsAndIncome.taxableBenefitsTable').innerHTML = buildTableFromMultipleChoiceNumbersAnswers('Select taxable benefits and enter amount');
  }

  function buildListFromRadioAnswers(questionId) {
      var options = getFromId(questionId).questionType.multipleChoiceOptions;

      return options.reduce(function (acc, option) {
          var answer = map.get(option.modelId);

          if (answer === "true") {
              return acc + '<h5>' + option.option + '</h5>'
          } else {
              return acc
          }
      }, "");
  }

  function buildTableFromMultipleChoiceNumbersAnswers(questionId) {
      var options = getFromId(questionId).questionType.multipleChoiceOptions;

      return options.reduce(function (acc, option) {
          var answer = map.get(option.modelId);

          if (typeof answer !== "undefined") {
              return acc + '<tr><td>' + option.option + '</td><td>' + Math.floor(parseFloat(answer)) + '</td></tr>'
          } else {
              return acc
          }
      }, "");
  }

  function sumMultipleNumberOption(questionId) {
      var options = getFromId(questionId).questionType.multipleChoiceOptions;

      var result = options.reduce(function (acc, option) {
          var answer = map.get(option.modelId);

          if (typeof answer !== "undefined") {
              return acc + parseFloat(answer)
          } else {
              return acc
          }
      }, 0);

      return Math.floor(result);
  }


</script>